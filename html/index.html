<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="pl">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>CostCalculationAPILibrary: Klient CostCalculationAPI dla Exel</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">CostCalculationAPILibrary
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Wygenerowano za pomocą Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Szukaj',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="doc-content">
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Wczytywanie...</div>
<div class="SRStatus" id="Searching">Szukanie...</div>
<div class="SRStatus" id="NoMatches">Brak dopasowań</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Klient CostCalculationAPI dla Exel </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="intro_sec"></a>
Wstęp</h1>
<p>Dokumentacja opisuje uzycie biblioteki w języku C# do komunikacji z API CostCalculationAPI.</p>
<div class="image">
<img src=".\codemap.png" alt=""/>
<div class="caption">
CodeMap</div></div>
 <div class="image">
<img src=".\Excel.png" alt=""/>
<div class="caption">
Naglowki z Excela</div></div>
<p>  Dokumentacja opisuje bilbiotekę C# COM oraz podaje przyklady uzycia analogicznych funkcji w VBA. W przyszlosci kod VBA zostanie zastąpiony przez bibliotekę COM+ </p>
<h1><a class="anchor" id="vba_fns"></a>
Funkcje VBA (wiecej w opspiach odpowiednich metod intefejsu ICostCalculationAPI)</h1>
<div class="fragment"><div class="line">Public Function CreateCalculation(name As String, username As String) As String</div>
<div class="line"> </div>
<div class="line">Public Function CreatePartition(calculationId As String, username As String, name As String, totalRMSTCost As Double, totalCost As Double, generalConstructionCost As Double, laboratoryCost As Double, geodesyCost As Double, generalCosts As Double, profitOrRisk As Double, financingCost As Double, finalUnitPriceInRequesterUnits As Double, totalValueInRequesterUnits As Double) As String</div>
<div class="line"> </div>
<div class="line">Public Function CreateSection(partitionId As String, username As String, itemNo As Long, description As String, unit As String, quantity As Double, quantityMade As Double, quantityCorrectionFactor As Double, unitConversionFactor As Double, convertedQuantity As Double, totalRMSTCost As Double, subcontractorName As String, subcontractorUnitPrice As Double, subcontractorValue As Double, _</div>
<div class="line">totalCost As Double, unitCostInRequesterUnits As Double, unitCostInCalculatedUnits As Double, generalConstructionCost As Double, laboratoryCost As Double, geodesyCost As Double, generalCosts As Double, profitOrRisk As Double, financingCost As Double, finalUnitPriceInRequesterUnits As Double, totalValueInRequesterUnits As Double, quantityMadeUnit As String, status As String) As String</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">Public Function CreateSubSection(sectionId As String, username As String, efficiency As Double, totalRMSTCost As Double, totalCost As Double, unitCostInRequesterUnits As Double, unitCostInCalculatedUnits As Double, Optional subsectionCode As String = <span class="stringliteral">&quot;&quot;</span>, Optional subsectionName As String = <span class="stringliteral">&quot;&quot;</span>, Optional efficiencyUnit As String = <span class="stringliteral">&quot;&quot;</span>) As String</div>
<div class="line"> </div>
<div class="line">Public Function CreateSubSubSection(subSectionId As String, username As String, typeValue As Long, totalRMSTCost As Double, totalCost As Double, unitCostInRequesterUnits As Double, unitCostInCalculatedUnits As Double, Optional subSubSectionName As String = &quot;&quot;) As String</div>
<div class="line"> </div>
<div class="line">Public Function CreateSubSubSectionItem(subSubSectionId As String, username As String, resourceQuantityForGivenEfficiency As Double, resourceQuantityTORMSTQuanity As Double, resourceUnitPrice As Double, totalResourceCost As Double, Optional resourceCode As String = &quot;&quot;, Optional unit As String = &quot;&quot;, Optional resourceName As String = &quot;&quot;) As String</div>
</div><!-- fragment --><h1><a class="anchor" id="usage_sec"></a>
ApiFunctions.vba</h1>
<div class="fragment"><div class="line"> Option Explicit</div>
<div class="line"> Private Const BASE_URL As String = <span class="stringliteral">&quot;http://localhost:5204&quot;</span> <span class="stringliteral">&#39; &lt;-- Change to your actual base URL</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral"> Private Function HttpPostJson(url As String, jsonBody As String) As String</span></div>
<div class="line"><span class="stringliteral">    Dim http As Object</span></div>
<div class="line"><span class="stringliteral">    Set http = CreateObject(&quot;WinHttp.WinHttpRequest.5.1&quot;)</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">    http.Open &quot;POST&quot;, url, False</span></div>
<div class="line"><span class="stringliteral">    http.SetRequestHeader &quot;Content-Type&quot;, &quot;application/json&quot;</span></div>
<div class="line"><span class="stringliteral">    &#39;</span> Add other headers <span class="keywordflow">if</span> necessary, e.g.:</div>
<div class="line">    <span class="stringliteral">&#39; http.SetRequestHeader &quot;Authorization&quot;, &quot;Bearer your_token_here&quot;</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">    http.Send jsonBody</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">   If http.status = 200 Or http.status = 201 Then</span></div>
<div class="line"><span class="stringliteral">    HttpPostJson = http.responseText</span></div>
<div class="line"><span class="stringliteral">    Else</span></div>
<div class="line"><span class="stringliteral">    Debug.Print &quot;HTTP Error: &quot; &amp; http.status &amp; &quot; - &quot; &amp; http.StatusText &amp; &quot; Response: &quot; &amp; http.responseText</span></div>
<div class="line"><span class="stringliteral">    Err.Raise vbObjectError + 1000, &quot;HttpPostJson&quot;, &quot;HTTP Error: &quot; &amp; http.status &amp; &quot; - &quot; &amp; http.StatusText &amp; &quot; Response: &quot; &amp; http.responseText</span></div>
<div class="line"><span class="stringliteral">    End If</span></div>
<div class="line"><span class="stringliteral">    End Function</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral"> Private Function ExtractIdFromJsonResponse(jsonResponse As String) As String</span></div>
<div class="line"><span class="stringliteral">    If Len(jsonResponse) &gt; 2 And Left(jsonResponse, 1) = &quot;&quot;&quot;&quot; And Right(jsonResponse, 1) = &quot;&quot;&quot;&quot; Then</span></div>
<div class="line"><span class="stringliteral">        ExtractIdFromJsonResponse = Mid(jsonResponse, 2, Len(jsonResponse) - 2)</span></div>
<div class="line"><span class="stringliteral">    Else</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">        ExtractIdFromJsonResponse = jsonResponse</span></div>
<div class="line"><span class="stringliteral">    End If</span></div>
<div class="line"><span class="stringliteral"> End Function</span></div>
<div class="line"><span class="stringliteral"> Private Function ToInvariantString(value As Double) As String</span></div>
<div class="line"><span class="stringliteral">    Dim s As String</span></div>
<div class="line"><span class="stringliteral">    s = CStr(value)</span></div>
<div class="line"><span class="stringliteral">    s = Replace(s, &quot;,&quot;, &quot;.&quot;)</span></div>
<div class="line"><span class="stringliteral">    ToInvariantString = s</span></div>
<div class="line"><span class="stringliteral"> End Function</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral"> Public Function CreateCalculation(name As String, username As String) As String</span></div>
<div class="line"><span class="stringliteral">    Dim url As String, jsonBody As String, response As String</span></div>
<div class="line"><span class="stringliteral">    url = BASE_URL &amp; &quot;/api/Calculations&quot;</span></div>
<div class="line"><span class="stringliteral">     jsonBody = &quot;{&quot;&quot;name&quot;&quot;: &quot;&quot;&quot; &amp; name &amp; &quot;&quot;&quot;, &quot;&quot;username&quot;&quot;: &quot;&quot;&quot; &amp; username &amp; &quot;&quot;&quot;}&quot;</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">    response = HttpPostJson(url, jsonBody)</span></div>
<div class="line"><span class="stringliteral">    CreateCalculation = ExtractIdFromJsonResponse(response)</span></div>
<div class="line"><span class="stringliteral"> End Function</span></div>
<div class="line"><span class="stringliteral"> Public Function CreatePartition(calculationId As String, username As String, name As String, totalRMSTCost As Double, totalCost As Double, _</span></div>
<div class="line"><span class="stringliteral">                                generalConstructionCost As Double, laboratoryCost As Double, _</span></div>
<div class="line"><span class="stringliteral">                                geodesyCost As Double, generalCosts As Double, _</span></div>
<div class="line"><span class="stringliteral">                                profitOrRisk As Double, financingCost As Double, _</span></div>
<div class="line"><span class="stringliteral">                                finalUnitPriceInRequesterUnits As Double, totalValueInRequesterUnits As Double) As String</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">    Dim url As String, jsonBody As String, response As String</span></div>
<div class="line"><span class="stringliteral">    url = BASE_URL &amp; &quot;/api/Partitions/&quot; &amp; calculationId</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">    jsonBody = &quot;{&quot; &amp; _</span></div>
<div class="line"><span class="stringliteral">        &quot;&quot;&quot;username&quot;&quot;: &quot;&quot;&quot; &amp; username &amp; &quot;&quot;&quot;,&quot; &amp; _</span></div>
<div class="line"><span class="stringliteral">        &quot;&quot;&quot;name&quot;&quot;: &quot;&quot;&quot; &amp; name &amp; &quot;&quot;&quot;,&quot; &amp; _</span></div>
<div class="line"><span class="stringliteral">        &quot;&quot;&quot;totalRMSTCost&quot;&quot;: &quot; &amp; ToInvariantString(totalRMSTCost) &amp; &quot;,&quot; &amp; _</span></div>
<div class="line"><span class="stringliteral">        &quot;&quot;&quot;totalCost&quot;&quot;: &quot; &amp; ToInvariantString(totalCost) &amp; &quot;,&quot; &amp; _</span></div>
<div class="line"><span class="stringliteral">        &quot;&quot;&quot;generalConstructionCost&quot;&quot;: &quot; &amp; ToInvariantString(generalConstructionCost) &amp; &quot;,&quot; &amp; _</span></div>
<div class="line"><span class="stringliteral">        &quot;&quot;&quot;laboratoryCost&quot;&quot;: &quot; &amp; ToInvariantString(laboratoryCost) &amp; &quot;,&quot; &amp; _</span></div>
<div class="line"><span class="stringliteral">        &quot;&quot;&quot;geodesyCost&quot;&quot;: &quot; &amp; ToInvariantString(geodesyCost) &amp; &quot;,&quot; &amp; _</span></div>
<div class="line"><span class="stringliteral">        &quot;&quot;&quot;generalCosts&quot;&quot;: &quot; &amp; ToInvariantString(generalCosts) &amp; &quot;,&quot; &amp; _</span></div>
<div class="line"><span class="stringliteral">        &quot;&quot;&quot;profitOrRisk&quot;&quot;: &quot; &amp; ToInvariantString(profitOrRisk) &amp; &quot;,&quot; &amp; _</span></div>
<div class="line"><span class="stringliteral">        &quot;&quot;&quot;financingCost&quot;&quot;: &quot; &amp; ToInvariantString(financingCost) &amp; &quot;,&quot; &amp; _</span></div>
<div class="line"><span class="stringliteral">        &quot;&quot;&quot;finalUnitPriceInRequesterUnits&quot;&quot;: &quot; &amp; ToInvariantString(finalUnitPriceInRequesterUnits) &amp; &quot;,&quot; &amp; _</span></div>
<div class="line"><span class="stringliteral">        &quot;&quot;&quot;totalValueInRequesterUnits&quot;&quot;: &quot; &amp; ToInvariantString(totalValueInRequesterUnits) &amp; _</span></div>
<div class="line"><span class="stringliteral">        &quot;}&quot;</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">    response = HttpPostJson(url, jsonBody)</span></div>
<div class="line"><span class="stringliteral">    CreatePartition = ExtractIdFromJsonResponse(response)</span></div>
<div class="line"><span class="stringliteral"> End Function</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral"> Public Function CreateSection(partitionId As String, _</span></div>
<div class="line"><span class="stringliteral">                              username As String, itemNo As Long, _</span></div>
<div class="line"><span class="stringliteral">                              description As String, unit As String, _</span></div>
<div class="line"><span class="stringliteral">                              quantity As Double, quantityMade As Double, quantityCorrectionFactor As Double, _</span></div>
<div class="line"><span class="stringliteral">                              unitConversionFactor As Double, convertedQuantity As Double, _</span></div>
<div class="line"><span class="stringliteral">                              totalRMSTCost As Double, subcontractorName As String, subcontractorUnitPrice As Double, subcontractorValue As Double, _</span></div>
<div class="line"><span class="stringliteral">                              totalCost As Double, unitCostInRequesterUnits As Double, unitCostInCalculatedUnits As Double, _</span></div>
<div class="line"><span class="stringliteral">                              generalConstructionCost As Double, laboratoryCost As Double, geodesyCost As Double, _</span></div>
<div class="line"><span class="stringliteral">                              generalCosts As Double, profitOrRisk As Double, financingCost As Double, _</span></div>
<div class="line"><span class="stringliteral">                              finalUnitPriceInRequesterUnits As Double, totalValueInRequesterUnits As Double, _</span></div>
<div class="line"><span class="stringliteral">                              quantityMadeUnit As String, status As String) As String</span></div>
<div class="line"><span class="stringliteral">    Dim url As String, jsonBody As String, response As String</span></div>
<div class="line"><span class="stringliteral">    url = BASE_URL &amp; &quot;/api/Sections/&quot; &amp; partitionId</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">    jsonBody = &quot;{&quot; &amp; _</span></div>
<div class="line"><span class="stringliteral">        &quot;&quot;&quot;username&quot;&quot;: &quot;&quot;&quot; &amp; username &amp; &quot;&quot;&quot;,&quot; &amp; &quot;&quot;&quot;itemNo&quot;&quot;: &quot; &amp; itemNo &amp; &quot;,&quot; &amp; &quot;&quot;&quot;description&quot;&quot;: &quot;&quot;&quot; &amp; description &amp; &quot;&quot;&quot;,&quot; &amp; _</span></div>
<div class="line"><span class="stringliteral">        &quot;&quot;&quot;unit&quot;&quot;: &quot;&quot;&quot; &amp; unit &amp; &quot;&quot;&quot;,&quot; &amp; &quot;&quot;&quot;quantity&quot;&quot;: &quot; &amp; ToInvariantString(quantity) &amp; &quot;,&quot; &amp; &quot;&quot;&quot;quantityMade&quot;&quot;: &quot; &amp; ToInvariantString(quantityMade) &amp; &quot;,&quot; &amp; &quot;&quot;&quot;quantityCorrectionFactor&quot;&quot;: &quot; &amp; ToInvariantString(quantityCorrectionFactor) &amp; &quot;,&quot; &amp; &quot;&quot;&quot;unitConversionFactor&quot;&quot;: &quot; &amp; ToInvariantString(unitConversionFactor) &amp; &quot;,&quot; &amp; _</span></div>
<div class="line"><span class="stringliteral">        &quot;&quot;&quot;convertedQuantity&quot;&quot;: &quot; &amp; ToInvariantString(convertedQuantity) &amp; &quot;,&quot; &amp; &quot;&quot;&quot;totalRMSTCost&quot;&quot;: &quot; &amp; ToInvariantString(totalRMSTCost) &amp; &quot;,&quot; &amp; &quot;&quot;&quot;subcontractorName&quot;&quot;: &quot;&quot;&quot; &amp; subcontractorName &amp; &quot;&quot;&quot;,&quot; &amp; &quot;&quot;&quot;subcontractorUnitPrice&quot;&quot;: &quot; &amp; ToInvariantString(subcontractorUnitPrice) &amp; &quot;,&quot; &amp; _</span></div>
<div class="line"><span class="stringliteral">        &quot;&quot;&quot;subcontractorValue&quot;&quot;: &quot; &amp; ToInvariantString(subcontractorValue) &amp; &quot;,&quot; &amp; &quot;&quot;&quot;totalCost&quot;&quot;: &quot; &amp; ToInvariantString(totalCost) &amp; &quot;,&quot; &amp; &quot;&quot;&quot;unitCostInRequesterUnits&quot;&quot;: &quot; &amp; ToInvariantString(unitCostInRequesterUnits) &amp; &quot;,&quot; &amp; &quot;&quot;&quot;unitCostInCalculatedUnits&quot;&quot;: &quot; &amp; ToInvariantString(unitCostInCalculatedUnits) &amp; &quot;,&quot; &amp; _</span></div>
<div class="line"><span class="stringliteral">        &quot;&quot;&quot;generalConstructionCost&quot;&quot;: &quot; &amp; ToInvariantString(generalConstructionCost) &amp; &quot;,&quot; &amp; &quot;&quot;&quot;laboratoryCost&quot;&quot;: &quot; &amp; ToInvariantString(laboratoryCost) &amp; &quot;,&quot; &amp; &quot;&quot;&quot;geodesyCost&quot;&quot;: &quot; &amp; ToInvariantString(geodesyCost) &amp; &quot;,&quot; &amp; &quot;&quot;&quot;generalCosts&quot;&quot;: &quot; &amp; ToInvariantString(generalCosts) &amp; &quot;,&quot; &amp; _</span></div>
<div class="line"><span class="stringliteral">        &quot;&quot;&quot;profitOrRisk&quot;&quot;: &quot; &amp; ToInvariantString(profitOrRisk) &amp; &quot;,&quot; &amp; &quot;&quot;&quot;financingCost&quot;&quot;: &quot; &amp; ToInvariantString(financingCost) &amp; &quot;,&quot; &amp; &quot;&quot;&quot;finalUnitPriceInRequesterUnits&quot;&quot;: &quot; &amp; ToInvariantString(finalUnitPriceInRequesterUnits) &amp; &quot;,&quot; &amp; &quot;&quot;&quot;totalValueInRequesterUnits&quot;&quot;: &quot; &amp; ToInvariantString(totalValueInRequesterUnits) &amp; &quot;,&quot; &amp; _</span></div>
<div class="line"><span class="stringliteral">        &quot;&quot;&quot;quantityMadeUnit&quot;&quot;: &quot;&quot;&quot; &amp; quantityMadeUnit &amp; &quot;&quot;&quot;,&quot; &amp; &quot;&quot;&quot;status&quot;&quot;: &quot;&quot;&quot; &amp; status &amp; &quot;&quot;&quot;&quot; &amp; _</span></div>
<div class="line"><span class="stringliteral">        &quot;}&quot;</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">    response = HttpPostJson(url, jsonBody)</span></div>
<div class="line"><span class="stringliteral">    CreateSection = ExtractIdFromJsonResponse(response)</span></div>
<div class="line"><span class="stringliteral"> End Function</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral"> Public Function CreateSubSection(sectionId As String, _</span></div>
<div class="line"><span class="stringliteral">                                 username As String, efficiency As Double, _</span></div>
<div class="line"><span class="stringliteral">                                 totalRMSTCost As Double, totalCost As Double, _</span></div>
<div class="line"><span class="stringliteral">                                 unitCostInRequesterUnits As Double, unitCostInCalculatedUnits As Double, _</span></div>
<div class="line"><span class="stringliteral">                                 Optional subsectionCode As String = &quot;&quot;, _</span></div>
<div class="line"><span class="stringliteral">                                 Optional subsectionName As String = &quot;&quot;, _</span></div>
<div class="line"><span class="stringliteral">                                 Optional efficiencyUnit As String = &quot;&quot;) As String</span></div>
<div class="line"><span class="stringliteral">    Dim url As String, jsonBody As String, response As String</span></div>
<div class="line"><span class="stringliteral">    url = BASE_URL &amp; &quot;/api/SubSections/&quot; &amp; sectionId</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">    Dim codeJson As String</span></div>
<div class="line"><span class="stringliteral">    Dim nameJson As String</span></div>
<div class="line"><span class="stringliteral">    Dim effUnitJson As String</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">    If subsectionCode = &quot;&quot; Then</span></div>
<div class="line"><span class="stringliteral">        codeJson = &quot;&quot;&quot;subsectionCode&quot;&quot;: null,&quot;</span></div>
<div class="line"><span class="stringliteral">    Else</span></div>
<div class="line"><span class="stringliteral">        codeJson = &quot;&quot;&quot;subsectionCode&quot;&quot;: &quot;&quot;&quot; &amp; subsectionCode &amp; &quot;&quot;&quot;,&quot;</span></div>
<div class="line"><span class="stringliteral">    End If</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">    If subsectionName = &quot;&quot; Then</span></div>
<div class="line"><span class="stringliteral">        nameJson = &quot;&quot;&quot;subsectionName&quot;&quot;: null,&quot;</span></div>
<div class="line"><span class="stringliteral">    Else</span></div>
<div class="line"><span class="stringliteral">        nameJson = &quot;&quot;&quot;subsectionName&quot;&quot;: &quot;&quot;&quot; &amp; subsectionName &amp; &quot;&quot;&quot;,&quot;</span></div>
<div class="line"><span class="stringliteral">    End If</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">    If efficiencyUnit = &quot;&quot; Then</span></div>
<div class="line"><span class="stringliteral">        effUnitJson = &quot;&quot;&quot;efficiencyUnit&quot;&quot;: null,&quot;</span></div>
<div class="line"><span class="stringliteral">    Else</span></div>
<div class="line"><span class="stringliteral">        effUnitJson = &quot;&quot;&quot;efficiencyUnit&quot;&quot;: &quot;&quot;&quot; &amp; efficiencyUnit &amp; &quot;&quot;&quot;,&quot;</span></div>
<div class="line"><span class="stringliteral">    End If</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">    jsonBody = &quot;{&quot; &amp; _</span></div>
<div class="line"><span class="stringliteral">        &quot;&quot;&quot;username&quot;&quot;: &quot;&quot;&quot; &amp; username &amp; &quot;&quot;&quot;,&quot; &amp; _</span></div>
<div class="line"><span class="stringliteral">         codeJson &amp; _</span></div>
<div class="line"><span class="stringliteral">         nameJson &amp; _</span></div>
<div class="line"><span class="stringliteral">        &quot;&quot;&quot;efficiency&quot;&quot;: &quot; &amp; ToInvariantString(efficiency) &amp; &quot;,&quot; &amp; _</span></div>
<div class="line"><span class="stringliteral">         effUnitJson &amp; _</span></div>
<div class="line"><span class="stringliteral">        &quot;&quot;&quot;totalRMSTCost&quot;&quot;: &quot; &amp; ToInvariantString(totalRMSTCost) &amp; &quot;,&quot; &amp; _</span></div>
<div class="line"><span class="stringliteral">        &quot;&quot;&quot;totalCost&quot;&quot;: &quot; &amp; ToInvariantString(totalCost) &amp; &quot;,&quot; &amp; _</span></div>
<div class="line"><span class="stringliteral">        &quot;&quot;&quot;unitCostInRequesterUnits&quot;&quot;: &quot; &amp; ToInvariantString(unitCostInRequesterUnits) &amp; &quot;,&quot; &amp; _</span></div>
<div class="line"><span class="stringliteral">        &quot;&quot;&quot;unitCostInCalculatedUnits&quot;&quot;: &quot; &amp; ToInvariantString(unitCostInCalculatedUnits) &amp; _</span></div>
<div class="line"><span class="stringliteral">        &quot;}&quot;</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">    response = HttpPostJson(url, jsonBody)</span></div>
<div class="line"><span class="stringliteral">    CreateSubSection = ExtractIdFromJsonResponse(response)</span></div>
<div class="line"><span class="stringliteral">End Function</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral"> Public Function CreateSubSubSection(subSectionId As String, _</span></div>
<div class="line"><span class="stringliteral">                                    username As String, typeValue As Long, _</span></div>
<div class="line"><span class="stringliteral">                                    totalRMSTCost As Double, totalCost As Double, _</span></div>
<div class="line"><span class="stringliteral">                                    unitCostInRequesterUnits As Double, unitCostInCalculatedUnits As Double, _</span></div>
<div class="line"><span class="stringliteral">                                    Optional subSubSectionName As String = &quot;&quot;) As String</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">    Dim url As String, jsonBody As String, response As String</span></div>
<div class="line"><span class="stringliteral">    url = BASE_URL &amp; &quot;/api/SubSubSections/&quot; &amp; subSectionId</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">    Dim nameJson As String</span></div>
<div class="line"><span class="stringliteral">    If subSubSectionName = &quot;&quot; Then</span></div>
<div class="line"><span class="stringliteral">        nameJson = &quot;&quot;&quot;subSubSectionName&quot;&quot;: null,&quot;</span></div>
<div class="line"><span class="stringliteral">    Else</span></div>
<div class="line"><span class="stringliteral">        nameJson = &quot;&quot;&quot;subSubSectionName&quot;&quot;: &quot;&quot;&quot; &amp; subSubSectionName &amp; &quot;&quot;&quot;,&quot;</span></div>
<div class="line"><span class="stringliteral">    End If</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">    jsonBody = &quot;{&quot; &amp; _</span></div>
<div class="line"><span class="stringliteral">        &quot;&quot;&quot;username&quot;&quot;: &quot;&quot;&quot; &amp; username &amp; &quot;&quot;&quot;,&quot; &amp; _</span></div>
<div class="line"><span class="stringliteral">         nameJson &amp; _</span></div>
<div class="line"><span class="stringliteral">        &quot;&quot;&quot;type&quot;&quot;: &quot; &amp; typeValue &amp; &quot;,&quot; &amp; _</span></div>
<div class="line"><span class="stringliteral">        &quot;&quot;&quot;totalRMSTCost&quot;&quot;: &quot; &amp; ToInvariantString(totalRMSTCost) &amp; &quot;,&quot; &amp; _</span></div>
<div class="line"><span class="stringliteral">        &quot;&quot;&quot;totalCost&quot;&quot;: &quot; &amp; ToInvariantString(totalCost) &amp; &quot;,&quot; &amp; _</span></div>
<div class="line"><span class="stringliteral">        &quot;&quot;&quot;unitCostInRequesterUnits&quot;&quot;: &quot; &amp; ToInvariantString(unitCostInRequesterUnits) &amp; &quot;,&quot; &amp; _</span></div>
<div class="line"><span class="stringliteral">        &quot;&quot;&quot;unitCostInCalculatedUnits&quot;&quot;: &quot; &amp; ToInvariantString(unitCostInCalculatedUnits) &amp; _</span></div>
<div class="line"><span class="stringliteral">        &quot;}&quot;</span></div>
<div class="line"><span class="stringliteral">    Debug.Print jsonBody</span></div>
<div class="line"><span class="stringliteral">    response = HttpPostJson(url, jsonBody)</span></div>
<div class="line"><span class="stringliteral">    CreateSubSubSection = ExtractIdFromJsonResponse(response)</span></div>
<div class="line"><span class="stringliteral"> End Function</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral"> Public Function CreateSubSubSectionItem(subSubSectionId As String, _</span></div>
<div class="line"><span class="stringliteral">    username As String, _</span></div>
<div class="line"><span class="stringliteral">                                       resourceQuantityForGivenEfficiency As Double, resourceQuantityTORMSTQuanity As Double, _</span></div>
<div class="line"><span class="stringliteral">                                        resourceUnitPrice As Double, totalResourceCost As Double, _</span></div>
<div class="line"><span class="stringliteral">                                        Optional resourceCode As String = &quot;&quot;, Optional unit As String = &quot;&quot;, Optional resourceName As String = &quot;&quot;) As String</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">    Dim url As String, jsonBody As String, response As String</span></div>
<div class="line"><span class="stringliteral">    url = BASE_URL &amp; &quot;/api/SubSubSectionItems/&quot; &amp; subSubSectionId</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">    Dim codeJson As String, unitJson As String, nameJson As String</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">    If resourceCode = &quot;&quot; Then</span></div>
<div class="line"><span class="stringliteral">        codeJson = &quot;&quot;&quot;resourceCode&quot;&quot;: null,&quot;</span></div>
<div class="line"><span class="stringliteral">    Else</span></div>
<div class="line"><span class="stringliteral">        codeJson = &quot;&quot;&quot;resourceCode&quot;&quot;: &quot;&quot;&quot; &amp; resourceCode &amp; &quot;&quot;&quot;,&quot;</span></div>
<div class="line"><span class="stringliteral">    End If</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">    If unit = &quot;&quot; Then</span></div>
<div class="line"><span class="stringliteral">        unitJson = &quot;&quot;&quot;unit&quot;&quot;: null,&quot;</span></div>
<div class="line"><span class="stringliteral">    Else</span></div>
<div class="line"><span class="stringliteral">        unitJson = &quot;&quot;&quot;unit&quot;&quot;: &quot;&quot;&quot; &amp; unit &amp; &quot;&quot;&quot;,&quot;</span></div>
<div class="line"><span class="stringliteral">    End If</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">    If resourceName = &quot;&quot; Then</span></div>
<div class="line"><span class="stringliteral">        nameJson = &quot;&quot;&quot;resourceName&quot;&quot;: null,&quot;</span></div>
<div class="line"><span class="stringliteral">    Else</span></div>
<div class="line"><span class="stringliteral">        nameJson = &quot;&quot;&quot;resourceName&quot;&quot;: &quot;&quot;&quot; &amp; resourceName &amp; &quot;&quot;&quot;,&quot;</span></div>
<div class="line"><span class="stringliteral">    End If</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">    jsonBody = &quot;{&quot; &amp; _</span></div>
<div class="line"><span class="stringliteral">        &quot;&quot;&quot;username&quot;&quot;: &quot;&quot;&quot; &amp; username &amp; &quot;&quot;&quot;,&quot; &amp; _</span></div>
<div class="line"><span class="stringliteral">         codeJson &amp; _</span></div>
<div class="line"><span class="stringliteral">         nameJson &amp; _</span></div>
<div class="line"><span class="stringliteral">         unitJson &amp; _</span></div>
<div class="line"><span class="stringliteral">        &quot;&quot;&quot;resourceQuantityForGivenEfficiency&quot;&quot;: &quot; &amp; ToInvariantString(resourceQuantityForGivenEfficiency) &amp; &quot;,&quot; &amp; _</span></div>
<div class="line"><span class="stringliteral">        &quot;&quot;&quot;resourceQuantityTORMSTQuanity&quot;&quot;: &quot; &amp; ToInvariantString(resourceQuantityTORMSTQuanity) &amp; &quot;,&quot; &amp; _</span></div>
<div class="line"><span class="stringliteral">        &quot;&quot;&quot;resourceUnitPrice&quot;&quot;: &quot; &amp; ToInvariantString(resourceUnitPrice) &amp; &quot;,&quot; &amp; _</span></div>
<div class="line"><span class="stringliteral">        &quot;&quot;&quot;totalResourceCost&quot;&quot;: &quot; &amp; ToInvariantString(totalResourceCost) &amp; _</span></div>
<div class="line"><span class="stringliteral">        &quot;}&quot;</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">    response = HttpPostJson(url, jsonBody)</span></div>
<div class="line"><span class="stringliteral">    CreateSubSubSectionItem = ExtractIdFromJsonResponse(response)</span></div>
<div class="line"><span class="stringliteral"> End Function</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral"> Public Function CreateNewVersion(calculationId As String, _</span></div>
<div class="line"><span class="stringliteral">                                 previousVersionId As String, description As String, userId As String) As String</span></div>
<div class="line"><span class="stringliteral">    Dim url As String, jsonBody As String, response As String</span></div>
<div class="line"><span class="stringliteral">    url = BASE_URL &amp; &quot;/api/Versions/&quot; &amp; calculationId &amp; &quot;/new-version&quot;</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">    jsonBody = &quot;{&quot; &amp; _</span></div>
<div class="line"><span class="stringliteral">        &quot;&quot;&quot;previousVersionId&quot;&quot;: &quot;&quot;&quot; &amp; previousVersionId &amp; &quot;&quot;&quot;,&quot; &amp; _</span></div>
<div class="line"><span class="stringliteral">        &quot;&quot;&quot;description&quot;&quot;: &quot;&quot;&quot; &amp; description &amp; &quot;&quot;&quot;,&quot; &amp; _</span></div>
<div class="line"><span class="stringliteral">        &quot;&quot;&quot;userId&quot;&quot;: &quot;&quot;&quot; &amp; userId &amp; &quot;&quot;&quot;&quot; &amp; _</span></div>
<div class="line"><span class="stringliteral">        &quot;}&quot;</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">    response = HttpPostJson(url, jsonBody)</span></div>
<div class="line"><span class="stringliteral">    CreateNewVersion = ExtractIdFromJsonResponse(response)</span></div>
<div class="line"><span class="stringliteral"> End Function</span></div>
</div><!-- fragment --><h1><a class="anchor" id="test_sec"></a>
Testowanie metod vba, Test.vba</h1>
<div class="fragment"><div class="line"> Option Explicit</div>
<div class="line"> </div>
<div class="line"><span class="stringliteral">&#39; -------------------------------------------</span></div>
<div class="line"><span class="stringliteral">&#39;</span> Test <span class="keywordflow">for</span> CreateCalculation</div>
<div class="line"><span class="stringliteral">&#39; -------------------------------------------</span></div>
<div class="line"><span class="stringliteral">Sub Test_CreateCalculation()</span></div>
<div class="line"><span class="stringliteral">    Dim calcId As String</span></div>
<div class="line"><span class="stringliteral">    calcId = CreateCalculation(&quot;Test Calculation Name&quot;, &quot;string&quot;)</span></div>
<div class="line"><span class="stringliteral">    Debug.Print &quot;Created Calculation ID: &quot; &amp; calcId</span></div>
<div class="line"><span class="stringliteral">End Sub</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">&#39;</span> -------------------------------------------</div>
<div class="line"><span class="stringliteral">&#39; Test for CreatePartition</span></div>
<div class="line"><span class="stringliteral">&#39;</span> -------------------------------------------</div>
<div class="line">Sub Test_CreatePartition()</div>
<div class="line">    Dim calculationId As String</div>
<div class="line">    calculationId = CreateCalculation(&quot;Partition Test Calc&quot;, &quot;<span class="keywordtype">string</span>&quot;)</div>
<div class="line">    Debug.Print &quot;Created Calculation for Partition Test: &quot; &amp; calculationId</div>
<div class="line"> </div>
<div class="line">    Dim partitionId As String</div>
<div class="line">    partitionId = CreatePartition(calculationId, _</div>
<div class="line">                                  &quot;<span class="keywordtype">string</span>&quot;, _</div>
<div class="line">                                   &quot;Test Partition&quot;, _</div>
<div class="line">                                  1000<span class="preprocessor">#, 1200#, 100#, 50#, _</span></div>
<div class="line">                                  20#, 80#, 30#, 10#, _</div>
<div class="line">                                  15#, 1800#)</div>
<div class="line">    Debug.Print <span class="stringliteral">&quot;Created Partition ID: &quot;</span> &amp; partitionId</div>
<div class="line">End Sub</div>
<div class="line"> </div>
<div class="line"><span class="stringliteral">&#39; -------------------------------------------</span></div>
<div class="line"><span class="stringliteral">&#39;</span> Test <span class="keywordflow">for</span> CreateSection</div>
<div class="line"><span class="stringliteral">&#39; -------------------------------------------</span></div>
<div class="line"><span class="stringliteral">Sub Test_CreateSection()</span></div>
<div class="line"><span class="stringliteral">    Dim calcId As String, partitionId As String, sectionId As String</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">    &#39;</span> Create a Calculation</div>
<div class="line">    calcId = CreateCalculation(<span class="stringliteral">&quot;Section Test Calc&quot;</span>, <span class="stringliteral">&quot;string&quot;</span>)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">    <span class="stringliteral">&#39; Create a Partition</span></div>
<div class="line"><span class="stringliteral">    partitionId = CreatePartition(calcId, &quot;string&quot;, &quot;Partition for Section&quot;, _</span></div>
<div class="line"><span class="stringliteral">                                  1000#, 1200#, 100#, 50#, _</span></div>
<div class="line"><span class="stringliteral">                                  20#, 80#, 30#, 10#, _</span></div>
<div class="line"><span class="stringliteral">                                  15#, 1800#)</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">    &#39;</span> Create a Section with all required fields</div>
<div class="line">    sectionId = CreateSection(partitionId, <span class="stringliteral">&quot;string&quot;</span>, 100, _</div>
<div class="line">                              <span class="stringliteral">&quot;Section Description&quot;</span>, <span class="stringliteral">&quot;m3&quot;</span>, _</div>
<div class="line">                              50#, 10#, 1#, _</div>
<div class="line">                              1#, 50#, _</div>
<div class="line">                              500#, <span class="stringliteral">&quot;Subcontractor Inc.&quot;</span>, 10#, 500#, _</div>
<div class="line">                              600#, 12#, 12#, _</div>
<div class="line">                              20#, 10#, 5#, _</div>
<div class="line">                              15#, 5#, 2#, _</div>
<div class="line">                              13#, 650#, _</div>
<div class="line">                              <span class="stringliteral">&quot;m3&quot;</span>, <span class="stringliteral">&quot;Active&quot;</span>)</div>
<div class="line"> </div>
<div class="line">    Debug.Print &quot;Created Section ID: &quot; &amp; sectionId</div>
<div class="line">End Sub</div>
<div class="line">Sub Test_CreateSubSection()</div>
<div class="line">    Dim calcId As String, partitionId As String, sectionId As String, subSectionId As String</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">    calcId = CreateCalculation(&quot;SubSection Test Calc&quot;, &quot;<span class="keywordtype">string</span>&quot;)</div>
<div class="line">    partitionId = CreatePartition(calcId, &quot;<span class="keywordtype">string</span>&quot;, &quot;Partition for SubSection&quot;, _</div>
<div class="line">                                  1000<span class="preprocessor">#, 1200#, 100#, 50#, _</span></div>
<div class="line">                                  20#, 80#, 30#, 10#, _</div>
<div class="line">                                  15#, 1800#)</div>
<div class="line"> </div>
<div class="line">    <span class="stringliteral">&#39; Updated CreateSection with required fields</span></div>
<div class="line"><span class="stringliteral">    sectionId = CreateSection(partitionId, &quot;string&quot;, 100, _</span></div>
<div class="line"><span class="stringliteral">                              &quot;Section Description&quot;, &quot;m3&quot;, _</span></div>
<div class="line"><span class="stringliteral">                              50#, 10#, 1#, _</span></div>
<div class="line"><span class="stringliteral">                              1#, 50#, _</span></div>
<div class="line"><span class="stringliteral">                              500#, &quot;Subcontractor Inc.&quot;, 10#, 500#, _</span></div>
<div class="line"><span class="stringliteral">                              600#, 12#, 12#, _</span></div>
<div class="line"><span class="stringliteral">                              20#, 10#, 5#, _</span></div>
<div class="line"><span class="stringliteral">                              15#, 5#, 2#, _</span></div>
<div class="line"><span class="stringliteral">                              13#, 650#, _</span></div>
<div class="line"><span class="stringliteral">                              &quot;m3&quot;, &quot;Active&quot;)</span></div>
<div class="line"><span class="stringliteral">        subSectionId = CreateSubSection(sectionId, &quot;string&quot;, _</span></div>
<div class="line"><span class="stringliteral">                                    1, 0.9, _</span></div>
<div class="line"><span class="stringliteral">                                    300#, 350#, _</span></div>
<div class="line"><span class="stringliteral">                                    7#, &quot;ss code&quot;, &quot;ssname&quot;, &quot;efunit&quot;)</span></div>
<div class="line"><span class="stringliteral">    Debug.Print &quot;Created SubSection ID: &quot; &amp; subSectionId</span></div>
<div class="line"><span class="stringliteral">    &#39;</span> Now create a SubSection</div>
<div class="line"> </div>
<div class="line">End Sub</div>
<div class="line"> </div>
<div class="line">Sub Test_CreateSubSubSection()</div>
<div class="line">    Dim calcId As String, partitionId As String, sectionId As String, subSectionId As String, subSubSectionId As String</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">    calcId = CreateCalculation(&quot;SubSubSection Test Calc&quot;, &quot;<span class="keywordtype">string</span>&quot;)</div>
<div class="line">    partitionId = CreatePartition(calcId, &quot;<span class="keywordtype">string</span>&quot;, &quot;Partition for SubSubSection&quot;, _</div>
<div class="line">                                  1000<span class="preprocessor">#, 1200#, 100#, 50#, _</span></div>
<div class="line">                                  20#, 80#, 30#, 10#, _</div>
<div class="line">                                  15#, 1800#)</div>
<div class="line"> </div>
<div class="line">    sectionId = CreateSection(partitionId, <span class="stringliteral">&quot;string&quot;</span>, 100, _</div>
<div class="line">                              <span class="stringliteral">&quot;Section Description&quot;</span>, <span class="stringliteral">&quot;m3&quot;</span>, _</div>
<div class="line">                              50#, 10#, 1#, _</div>
<div class="line">                              1#, 50#, _</div>
<div class="line">                              500#, <span class="stringliteral">&quot;Subcontractor Inc.&quot;</span>, 10#, 500#, _</div>
<div class="line">                              600#, 12#, 12#, _</div>
<div class="line">                              20#, 10#, 5#, _</div>
<div class="line">                              15#, 5#, 2#, _</div>
<div class="line">                              13#, 650#, _</div>
<div class="line">                              <span class="stringliteral">&quot;m3&quot;</span>, <span class="stringliteral">&quot;Active&quot;</span>)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">        subSectionId = CreateSubSection(sectionId, &quot;<span class="keywordtype">string</span>&quot;, _</div>
<div class="line">                                    1, 0.9, _</div>
<div class="line">                                    300<span class="preprocessor">#, 350#, _</span></div>
<div class="line">                                    7#, <span class="stringliteral">&quot;ss code2&quot;</span>, <span class="stringliteral">&quot;ssname2&quot;</span>, <span class="stringliteral">&quot;efunit2&quot;</span>)</div>
<div class="line"> </div>
<div class="line">    subSubSectionId = CreateSubSubSection(subSectionId, _</div>
<div class="line">                                          <span class="stringliteral">&quot;string&quot;</span>, _</div>
<div class="line">                                          1, 0, _</div>
<div class="line">                                          100#, 120#, _</div>
<div class="line">                                          1.2, 1.2)</div>
<div class="line">    Debug.Print &quot;Created SubSubSection ID: &quot; &amp; subSubSectionId</div>
<div class="line">End Sub</div>
<div class="line"> </div>
<div class="line">Sub Test_CreateSubSubSectionItem()</div>
<div class="line">    Dim calcId As String, partitionId As String, sectionId As String</div>
<div class="line">    Dim subSectionId As String, subSubSectionId As String, subSubSectionItemId As String</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">    calcId = CreateCalculation(&quot;SubSubSectionItem Test Calc&quot;, &quot;<span class="keywordtype">string</span>&quot;)</div>
<div class="line">    partitionId = CreatePartition(calcId, &quot;<span class="keywordtype">string</span>&quot;, &quot;Partition for SubSubSectionItem&quot;, _</div>
<div class="line">                                  1000<span class="preprocessor">#, 1200#, 100#, 50#, _</span></div>
<div class="line">                                  20#, 80#, 30#, 10#, _</div>
<div class="line">                                  15#, 1800#)</div>
<div class="line"> </div>
<div class="line">    sectionId = CreateSection(partitionId, <span class="stringliteral">&quot;string&quot;</span>, 100, _</div>
<div class="line">                              <span class="stringliteral">&quot;Section DescriptionItem&quot;</span>, <span class="stringliteral">&quot;m3&quot;</span>, _</div>
<div class="line">                              50#, 10#, 1#, _</div>
<div class="line">                              1#, 50#, _</div>
<div class="line">                              500#, <span class="stringliteral">&quot;Subcontractor Inc.&quot;</span>, 10#, 500#, _</div>
<div class="line">                              600#, 12#, 12#, _</div>
<div class="line">                              20#, 10#, 5#, _</div>
<div class="line">                              15#, 5#, 2#, _</div>
<div class="line">                              13#, 650#, _</div>
<div class="line">                              <span class="stringliteral">&quot;m3&quot;</span>, <span class="stringliteral">&quot;Active&quot;</span>)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">        subSectionId = CreateSubSection(sectionId, &quot;<span class="keywordtype">string</span>&quot;, _</div>
<div class="line">                                    1, 0.9, _</div>
<div class="line">                                    300<span class="preprocessor">#, 350#, _</span></div>
<div class="line">                                    7#, <span class="stringliteral">&quot;ss code2&quot;</span>, <span class="stringliteral">&quot;ssname2&quot;</span>, <span class="stringliteral">&quot;efunit2&quot;</span>)</div>
<div class="line"> </div>
<div class="line">    subSubSectionId = CreateSubSubSection(subSectionId, _</div>
<div class="line">                                          <span class="stringliteral">&quot;string&quot;</span>, _</div>
<div class="line">                                          1, 0, _</div>
<div class="line">                                          100#, 120#, _</div>
<div class="line">                                          1.2, 1.2)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">    subSubSectionItemId = CreateSubSubSectionItem(subSubSectionId, _</div>
<div class="line">                                                  &quot;<span class="keywordtype">string</span>&quot;, _</div>
<div class="line">                                                  10<span class="preprocessor">#, 10#, _</span></div>
<div class="line">                                                  5#, 50#, <span class="stringliteral">&quot;c&quot;</span>, <span class="stringliteral">&quot;jm&quot;</span>, <span class="stringliteral">&quot;ssss&quot;</span>)</div>
<div class="line">    Debug.Print <span class="stringliteral">&quot;Created SubSubSectionItem ID: &quot;</span> &amp; subSubSectionItemId</div>
<div class="line">End Sub</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">Sub Test_All()</div>
<div class="line">    Dim calcId As String, partitionId As String, sectionId As String</div>
<div class="line">    Dim subSectionId As String, subSubSectionId As String, subSubSectionItemId As String</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">    calcId = CreateCalculation(<span class="stringliteral">&quot;SubSubSectionItem Test Calc&quot;</span>, <span class="stringliteral">&quot;string&quot;</span>)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">    partitionId = CreatePartition(calcId, &quot;<span class="keywordtype">string</span>&quot;, &quot;Partition for SubSubSectionItem&quot;, 1000<span class="preprocessor">#, 1200#, 100#, 50#, 0#, 80#, 30#, 10#, 15#, 1800#)</span></div>
<div class="line"> </div>
<div class="line">    sectionId = CreateSection(partitionId, <span class="stringliteral">&quot;string&quot;</span>, 100, <span class="stringliteral">&quot;Section DescriptionItem&quot;</span>, <span class="stringliteral">&quot;m3&quot;</span>, 50#, 10#, 1#, 1#, 50#, 500#, <span class="stringliteral">&quot;Subcontractor Inc.&quot;</span>, 10#, 500#, 600#, 12#, 12#, 20#, 10#, 5#, 15#, 5#, 2#, 13#, 650#, <span class="stringliteral">&quot;m3&quot;</span>, <span class="stringliteral">&quot;Active&quot;</span>)</div>
<div class="line"> </div>
<div class="line">    subSectionId = CreateSubSection(sectionId, &quot;<span class="keywordtype">string</span>&quot;, 1, 0.9, 300<span class="preprocessor">#, 350#, 7#, &quot;ss code2&quot;, &quot;ssname2&quot;, &quot;efunit2&quot;)</span></div>
<div class="line"> </div>
<div class="line">    subSubSectionId = CreateSubSubSection(subSectionId, <span class="stringliteral">&quot;string&quot;</span>, 1, 0, 100#, 120#, 1.2, 1.2)</div>
<div class="line"> </div>
<div class="line">    subSubSectionItemId = CreateSubSubSectionItem(subSubSectionId, &quot;<span class="keywordtype">string</span>&quot;, 10<span class="preprocessor">#, 10#, 5#, 50#, &quot;c&quot;, &quot;jm&quot;, &quot;ssss&quot;)</span></div>
<div class="line"> </div>
<div class="line">End Sub</div>
</div><!-- fragment --> <h1><a class="anchor" id="more_info_sec"></a>
Więcej informacji</h1>
<p>Więcej informacji znajdziesz w dokumentacji poszzczególnych method. </p>
</div></div><!-- PageDoc -->
<a href="doxygen_crawl.html"></a>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Wygenerowano za pomocą&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
